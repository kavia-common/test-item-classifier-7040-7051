{"is_source_file": true, "format": "Python", "description": "This Python source file provides functions and classes for parsing, normalizing, and handling test plan import data from CSV and XLSX formats, including header normalization, data validation, and conversion to standardized internal representations.", "external_files": ["openpyxl"], "external_methods": ["csv.DictReader", "io.StringIO", "json.dumps", "openpyxl.load_workbook"], "published": ["normalize_rows", "parse_csv", "parse_xlsx", "dumps_json_text"], "classes": [{"name": "NormalizedRow", "description": "Data class representing a normalized test plan import row with standard fields."}], "methods": [{"name": "_norm_key", "description": "Normalizes header keys for matching by converting to lowercase and removing non-alphanumeric characters."}, {"name": "_split_multiline_steps", "description": "Splits multiline step descriptions into a list of individual steps."}, {"name": "_split_tags", "description": "Splits tags string into a list of individual tags."}, {"name": "_map_headers", "description": "Creates a mapping from column indices to standard header names based on header normalization and synonyms."}, {"name": "_coerce_str", "description": "Converts a value to a stripped string or None if empty."}, {"name": "normalize_rows", "description": "Converts raw row dictionaries into a list of normalized test plan rows with warnings for skipped rows."}, {"name": "parse_csv", "description": "Parses CSV bytes into a list of row dictionaries, enforcing UTF-8 encoding and row limits."}, {"name": "parse_xlsx", "description": "Parses XLSX bytes into a list of row dictionaries, requiring 'openpyxl' and handling headers and data rows."}, {"name": "dumps_json_text", "description": "Serializes a value to JSON text or returns None if the value is None."}], "calls": ["csv.DictReader", "io.StringIO", "json.dumps", "openpyxl.load_workbook"], "search-terms": ["test plan import", "CSV parsing", "XLSX parsing", "header normalization", "test case normalization", "test plan data handling"], "state": 2, "file_id": 7, "knowledge_revision": 34, "git_revision": "e9a483682842a4f1ac10a241970d45b76428d3ff", "revision_history": [{"19": "30d78b615f53bdbe40b88a50e350b9c9ce34c41c"}, {"24": "e9a483682842a4f1ac10a241970d45b76428d3ff"}, {"34": "e9a483682842a4f1ac10a241970d45b76428d3ff"}], "ctags": [], "filename": "backend/src/api/testplan_import.py", "format-version": 4, "code-base-name": "https://github.com/kavia-common/test-item-classifier-7040-7051.git:kavia-main"}